# ゲーム要件定義書

## プロジェクト概要

**プロジェクト名**: MOBA × 弾幕シューティングゲーム（仮称）

**コンセプト**: LoLの操作感と東方Projectの弾幕要素を融合させた、新しいタイプのアクションゲーム

**ターゲットプラットフォーム**: Webブラウザ（PC）

---

## 1. 技術仕様

### 1.1 技術スタック
- **ゲームエンジン**: Phaser 3
- **言語**: TypeScript
- **ビルドツール**: Vite
- **状態管理**: Zustand
- **パッケージマネージャー**: npm/pnpm

### 1.2 開発環境
- Node.js 18+
- 対応ブラウザ: Chrome, Firefox, Edge（最新版）
- 推奨解像度: 1920x1080

---

## 2. ゲームシステム仕様

### 2.1 基本仕様
- **視点**: トップダウン視点（真上から見下ろす）
- **プレイ人数**: シングルプレイヤー
- **ゲームジャンル**: 弾幕アクションシューティング

### 2.2 操作方法

#### 2.2.1 基本操作
- **移動**: 右クリック（LoL風の移動指示）
- **通常攻撃（AA）**: 自動攻撃または左クリック
- **スキル使用**:
  - Q, W, E, R: キャラクター固有スキル
  - D, F: プレイヤー選択スキル（サモナースペル的な位置づけ）

#### 2.2.2 その他操作
- **ESC**: 一時停止/メニュー
- **Tab**: スコア/統計表示（オプション）

---

## 3. キャラクターシステム

### 3.1 キャラクター選択
- **選択タイミング**: ステージ開始前
- **初期実装キャラクター数**: 4キャラクター
- **各キャラクターの構成**:
  - 固有スキル4種（Q, W, E, R）
  - 固有の通常攻撃（AA）
  - 基礎ステータス（HP, 移動速度, 攻撃力等）

### 3.2 キャラクタースペック例

| 項目 | 説明 |
|------|------|
| HP | 体力（例: 100-200） |
| 移動速度 | 基礎移動速度 |
| 攻撃力 | 通常攻撃のダメージ |
| 攻撃速度 | AA の発動間隔 |
| 攻撃射程 | AA の射程距離 |
| 当たり判定サイズ | 被弾判定の大きさ |

### 3.3 プレイヤー選択スキル（D/F）
- **選択タイミング**: ステージ開始前
- **スキル種類例**:
  - 瞬間移動（ブリンク/フラッシュ）
  - シールド生成
  - 時間停止
  - 弾幕消去
  - HP回復
  - ダメージブースト

---

## 4. スキルシステム

### 4.1 スキル仕様
- **発動方式**: キーボード入力
- **クールダウン制**: LoL風のクールダウンシステム
- **スキルの種類**:
  - 攻撃スキル（弾幕、範囲攻撃等）
  - 防御スキル（シールド、回避等）
  - 移動スキル（ダッシュ、ブリンク等）
  - サポートスキル（バフ、デバフ等）

### 4.2 通常攻撃（AA）
- **発動方式**:
  - オートアタック（敵が射程内にいる場合自動発動）
  - または左クリックによる手動指示
- **特性**:
  - クールダウンなし（攻撃速度による制限）
  - キャラクターごとに異なる弾種・エフェクト

---

## 5. HP・残機システム

### 5.1 HP（ヒットポイント）
- **初期HP**: キャラクターごとに設定（例: 100-200）
- **ダメージ判定**:
  - 敵弾との接触
  - 敵本体との接触
  - 範囲攻撃エリアへの侵入
- **HP回復方法**:
  - 道中のHP回復アイテム取得
  - 一部スキルによる自己回復

### 5.2 残機システム
- **初期残機数**: 3機
- **復活仕様**:
  - その場で即座に復活
  - 復活後2秒間の無敵時間付与
  - HP全回復
- **ゲームオーバー条件**: 残機が0の状態でHPが0になる

---

## 6. ステージ構成

### 6.1 ステージ数
- **初期実装**: 6ステージ

### 6.2 ステージ構造
各ステージは以下の流れで構成：

```
[スタート地点]
    ↓
[道中セクション1] - 雑魚敵 + 弾幕
    ↓
[中ボス戦]
    ↓
[道中セクション2] - 雑魚敵 + 弾幕
    ↓
[ボス戦]
    ↓
[ステージクリア]
```

### 6.3 スクロール仕様
- **スクロール方式**: プレイヤーの前進移動に応じて画面が縦スクロール
- **後方境界**: プレイヤーが前進すると、後方エリアが侵入不可エリアになる
  - 後方境界に触れるとダメージ（またはゲームオーバー）
  - プレイヤーを前進させるメカニクス
- **スクロール速度**: プレイヤーの移動速度に依存

### 6.4 難易度設定
- **難易度レベル**: Easy / Normal / Hard
- **難易度による変化**:
  - 敵のHP・攻撃力
  - 弾幕の密度・速度
  - 敵の出現数
  - アイテムのドロップ率

---

## 7. 敵システム

### 7.1 敵の種類

#### 7.1.1 雑魚敵
- **特徴**: 基本的な弾幕パターン
- **HP**: 低～中
- **行動**:
  - 簡単な移動パターン
  - 単純な弾幕発射
  - 体当たり攻撃

#### 7.1.2 中ボス
- **特徴**: 複雑な弾幕パターン、複数フェーズ
- **HP**: 中～高
- **行動**:
  - 複数の攻撃パターン
  - 弾幕 + 範囲攻撃の組み合わせ
  - HP減少によるフェーズ変化

#### 7.1.3 ボス
- **特徴**: 多彩な攻撃パターン、複数フェーズ、スペルカード的要素
- **HP**: 高
- **行動**:
  - スペルカード（特殊攻撃パターン）
  - 複数フェーズ（HP閾値で変化）
  - 弾幕 + 範囲攻撃 + 召喚などの複合攻撃

### 7.2 攻撃パターン

#### 7.2.1 弾幕攻撃
- **パターン例**:
  - 自機狙い弾
  - 円形弾幕
  - 扇形弾幕
  - ランダム弾幕
  - レーザー
  - 追尾弾

#### 7.2.2 体当たり攻撃
- 敵本体との接触でダメージ
- 敵の当たり判定サイズに依存

#### 7.2.3 範囲攻撃（LoL風）
- **仕様**:
  - 予告エフェクト表示（0.5-1秒前）
  - 予告後に範囲内に判定発生
  - 高ダメージだが回避可能
- **形状例**:
  - 円形範囲
  - 直線範囲
  - 扇形範囲

---

## 8. アイテムシステム

### 8.1 アイテムドロップ
- **ドロップ源**:
  - 雑魚敵撃破時
  - 中ボス・ボス撃破時
  - 特定の破壊可能オブジェクト

### 8.2 アイテム種類

| アイテム | 効果 |
|----------|------|
| HP回復（小） | HP +20 |
| HP回復（大） | HP +50 |
| パワーアップ | 攻撃力一時増加 |
| 速度アップ | 移動速度一時増加 |
| シールド | 一定時間ダメージ無効化 |
| スコアアイテム | スコア加算 |
| 残機アップ | 残機 +1（レア） |

### 8.3 アイテム取得
- **取得方法**: プレイヤーキャラクターとの接触
- **自動吸引**: 一定範囲内のアイテムが自動的に引き寄せられる（オプション）

---

## 9. スコアシステム

### 9.1 スコア獲得方法
- **敵撃破**: 敵の種類に応じたスコア
- **ボス撃破**: 高スコア + タイムボーナス
- **アイテム取得**: スコアアイテム
- **ノーダメージボーナス**: セクションごと
- **ノーミスボーナス**: 残機を失わない

### 9.2 ランク評価
ステージクリア時の評価:
- **S**: 最高評価（ノーミス、高スコア等）
- **A**: 優秀
- **B**: 良好
- **C**: クリア

評価基準:
- スコア
- クリアタイム
- 残機数
- 被弾回数

---

## 10. プレイヤー成長システム

### 10.1 ステージクリア後の報酬
- **経験値**: キャラクターレベルアップ
- **通貨**: ゲーム内通貨取得
- **アンロック**: 新キャラクター、新D/Fスキル

### 10.2 キャラクター強化
- **レベルアップ**: ステータス上昇
- **スキル強化**: クールダウン短縮、威力向上等
- **アビリティアンロック**: 新しいパッシブ能力

### 10.3 プログレッションシステム
- **プレイヤーレベル**: 全体的な進行度
- **キャラクター別レベル**: 各キャラクターの習熟度
- **実績・チャレンジ**: 特定条件達成で報酬

---

## 11. UI/UX仕様

### 11.1 ゲーム中のUI

#### 11.1.1 HUD表示
- **HP バー**: 画面左上
- **残機数**: HPバーの近く
- **スキルアイコン**: 画面下部（Q/W/E/R/D/F）
  - クールダウン表示
  - 使用可能/不可の視覚的フィードバック
- **スコア**: 画面右上
- **ボスHPバー**: 画面上部（ボス戦時）
- **ミニマップ**: 画面右下（オプション）

#### 11.1.2 エフェクト
- **被弾エフェクト**: 画面フラッシュ、振動
- **スキル使用エフェクト**: 派手なビジュアルエフェクト
- **無敵時間**: キャラクター点滅

### 11.2 メニュー画面

#### 11.2.1 メインメニュー
- ゲームスタート
- キャラクター選択
- オプション
- 実績
- クレジット

#### 11.2.2 キャラクター選択画面
- キャラクター一覧
- キャラクタープレビュー
- スキル説明
- ステータス表示
- D/Fスキル選択

#### 11.2.3 ステージ選択画面
- ステージ一覧
- 難易度選択
- ハイスコア表示
- ランク表示

#### 11.2.4 一時停止メニュー
- 再開
- 再スタート
- オプション
- タイトルに戻る

---

## 12. サウンド仕様

### 12.1 BGM
- **メインメニュー**: 1曲
- **各ステージ**: 道中BGM 1曲 + ボスBGM 1曲
- **合計**: 最低13曲

### 12.2 SE（効果音）
- スキル使用音
- 通常攻撃音
- 被弾音
- 敵撃破音
- アイテム取得音
- UI操作音
- ボス警告音

---

## 13. パフォーマンス要件

### 13.1 フレームレート
- **目標FPS**: 60fps
- **最低FPS**: 30fps

### 13.2 最大同時表示オブジェクト
- **弾**: 500個
- **敵**: 50体
- **エフェクト**: 100個

### 13.3 読み込み時間
- **初回ロード**: 10秒以内
- **ステージ間遷移**: 3秒以内

---

## 14. 開発フェーズ

### Phase 1: プロトタイプ（1-2ヶ月）
- [ ] 基本的な移動システム
- [ ] 通常攻撃実装
- [ ] 1キャラクター + 4スキル実装
- [ ] 簡易的な弾幕システム
- [ ] 1ステージのプロトタイプ

### Phase 2: コアシステム（2-3ヶ月）
- [ ] 4キャラクター実装
- [ ] D/Fスキルシステム
- [ ] 完全な弾幕システム
- [ ] 敵AI（雑魚、中ボス、ボス）
- [ ] HPシステム・残機システム
- [ ] アイテムシステム

### Phase 3: コンテンツ実装（2-3ヶ月）
- [ ] 6ステージ実装
- [ ] 各ステージのボスデザイン
- [ ] 弾幕パターン作成
- [ ] BGM/SE実装

### Phase 4: システム拡張（1-2ヶ月）
- [ ] スコアシステム
- [ ] ランク評価
- [ ] プレイヤー成長システム
- [ ] 実績システム
- [ ] 難易度調整

### Phase 5: ポリッシュ・調整（1-2ヶ月）
- [ ] バランス調整
- [ ] UI/UXブラッシュアップ
- [ ] パフォーマンス最適化
- [ ] バグ修正
- [ ] プレイテスト・フィードバック反映

---

## 15. 技術的課題と対策

### 15.1 弾幕処理の最適化
- **課題**: 大量の弾オブジェクトによるパフォーマンス低下
- **対策**:
  - オブジェクトプーリング
  - 画面外オブジェクトの非アクティブ化
  - パーティクルシステムの活用

### 15.2 衝突判定の最適化
- **課題**: 大量オブジェクト間の衝突判定
- **対策**:
  - 空間分割（QuadTree等）
  - 簡略化された当たり判定（円形、矩形）

### 15.3 状態管理
- **課題**: 複雑なゲーム状態の管理
- **対策**:
  - Zustandによる集中管理
  - ゲームループとUI状態の分離

---

## 16. 拡張性・将来的な機能

### 16.1 考慮事項
- マルチプレイヤーモード（協力・対戦）
- キャラクター追加のしやすさ
- 新ステージ追加のしやすさ
- モバイル対応
- ランキングシステム（オンライン）

### 16.2 コードアーキテクチャ
- モジュール化された設計
- キャラクター、スキル、敵のデータ駆動設計
- 設定ファイル（JSON）による柔軟な調整

---

## 17. セーブデータ仕様

### 17.1 保存内容
- プレイヤーレベル・経験値
- キャラクターレベル・強化状態
- ステージクリア状況・ハイスコア
- アンロック状態（キャラクター、スキル等）
- オプション設定

### 17.2 保存方法
- **ブラウザ**: localStorage または IndexedDB
- **将来的**: クラウドセーブ対応

---

## 18. デザイン方針

### 18.1 アートスタイル
- 2Dスプライト or 2Dベクター
- カラフルで視認性の高いデザイン
- 弾幕の見やすさを最優先

### 18.2 キャラクターデザイン
- 東方風の和風キャラクター
- 各キャラクターの個性的なシルエット
- スキルエフェクトとの調和

### 18.3 UIデザイン
- モダンでクリーンなUI
- LoL風のスキルアイコンデザイン
- 高コントラストで視認性重視

---

## 19. 参考ゲーム

- **League of Legends**: 操作感、スキルシステム
- **東方Project シリーズ**: 弾幕パターン、ボス戦
- **Vampire Survivors**: プログレッションシステム（参考）
- **Hades**: スキルビルド、ローグライト要素（参考）

---

## 20. 成功指標（KPI）

### 20.1 開発段階
- プロトタイプの完成度
- フレームレート安定性
- バグの数

### 20.2 リリース後
- プレイヤー数
- 平均プレイ時間
- ステージクリア率
- プレイヤーフィードバック

---

## 変更履歴

| 日付 | バージョン | 変更内容 |
|------|------------|----------|
| 2025-12-04 | 1.0 | 初版作成 |

