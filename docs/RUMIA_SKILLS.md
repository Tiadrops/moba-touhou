# ルーミア（Rumia）スキル詳細

ステージ1ボス「宵闇の妖怪」

## 基本ステータス

| ステータス | 値 |
|-----------|-----|
| HP | 5000（フェーズ0） |
| ATK | 25 |
| DEF | 50 (約33%ダメージ軽減) |
| 移動速度 | 120 px/s |
| ヒットボックス半径 | 40 px |

## アニメーション

| 状態 | 使用スプライト | フレーム数 | フレームレート |
|------|---------------|-----------|---------------|
| 待機中 | rumia_koma2.png | 4 | 1.5fps |
| 詠唱中 | rumia_koma1.png | 4 | 1.5fps |
| 移動中 | rumia_koma3.png | 2 | 4fps |

- 待機・詠唱のフレーム順: 1→3→2→4
- 移動のフレーム順: 1→2

---

## Qスキル「通常弾幕1」

プレイヤー方向に向けて予告線を順次表示し、弾幕を発射する基本攻撃スキル。
**CC（スタン）で中断可能。**

### パラメータ

| 項目 | 値 |
|------|-----|
| 詠唱時間 | 1400ms (7本 × 200ms) |
| クールダウン | 5000ms |
| 基礎ダメージ | 30 |
| ATK係数 | 0.5 (ATK × 50%) |

### 弾幕パラメータ

| 項目 | 値 |
|------|-----|
| 予告線の本数 | 7本 |
| 予告線の出現間隔 | 200ms |
| 予告線から弾発射までの遅延 | 300ms |
| 縦方向の弾数 | 10発/列 |
| 縦方向の弾間隔 | 40px |
| 横方向の弾間隔 | 30px |
| 弾速 | 1100 px/s (20m/s) |
| 弾の半径 | 13.75px (0.25m) |
| 弾タイプ | KSHOT.MEDIUM_BALL.RED |
| 表示スケール | 0.06 |

### 予告線ごとの弾数

| 予告線番号 | 横方向の列数 |
|-----------|-------------|
| 1本目 | 1列 |
| 2-3本目 | 2列 |
| 4-6本目 | 3列 |
| 7本目 | 4列 |

### 挙動

1. **詠唱フェーズ**: 200ms間隔で予告線が順次出現（各予告線はプレイヤー方向を狙う）
2. **発射フェーズ**: 各予告線の出現から300ms後に弾幕発射
3. 弾は「八の字」に広がるように角度がつく（各列が中心から3度ずつ広がる）
4. CCで中断された場合、即座にクールダウンに入る

---

## Wスキル「闇符・ダークサイドオブムーン」

自機狙いレーザー1本とランダム方向レーザー4本を発射する範囲攻撃。

### パラメータ

| 項目 | 値 |
|------|-----|
| 詠唱時間 | 500ms |
| クールダウン | 4000ms |
| 基礎ダメージ | 50 |
| ATK係数 | 0.8 (ATK × 80%) |

### レーザーパラメータ

| 項目 | 値 |
|------|-----|
| レーザー総数 | 5本 |
| レーザー幅 | 30 px |
| レーザー長さ | 800 px |
| ダメージ判定時間 | 100ms |

### 挙動

1. **詠唱フェーズ**: 5本のレーザー予告線が表示される
   - 1本目: プレイヤーへの自機狙い
   - 2〜5本目: プレイヤー方向を中心に±60度（120度範囲）のランダム方向
2. **発射フェーズ**: レーザーが発射され、接触したプレイヤーにダメージ
3. ダメージは1回のスキルで1回のみ（多段ヒットなし）

### 備考

- レーザーはプレイエリア内にクリッピングされる
- 予告線はオレンジ色（0xff6600）、レーザー本体は赤色（0xff0000）

---

## Eスキル「闘符・ディマーケイション」

ルーミアを中心に拡大する円形弾幕。各波が交互に回転する東方らしい弾幕パターン。

### パラメータ

| 項目 | 値 |
|------|-----|
| 詠唱時間 | 300ms |
| クールダウン | 6000ms |
| 基礎ダメージ | 20 |
| ATK係数 | 0.3 (ATK × 30%) |

### 弾幕パラメータ

| 項目 | 値 |
|------|-----|
| 1リングあたりの弾数 | 16発 |
| 波の数 | 3波 |
| 波の発射間隔 | 400ms |
| 初期半径 | 30 px |
| 拡大速度 | 200 px/s |
| 回転速度 | 0.8 rad/s (約46度/s) |
| 弾タイプ | KSHOT.MEDIUM_BALL.MAGENTA |
| 弾のサイズ | 512x512 px |
| 当たり判定半径 | 220 px |

### 挙動

1. **詠唱フェーズ**: 詠唱完了まで待機
2. **発射フェーズ**:
   - 400ms間隔で3波の円形弾幕を発射
   - 各波は16発の弾がリング状に配置
   - 弾はルーミアを中心に拡大しながら回転
   - **偶数波（1波目、3波目）**: 時計回りに回転
   - **奇数波（2波目）**: 反時計回りに回転
3. プレイエリア外に出た弾は自動的に削除

### 備考

- 東方紅魔郷のルーミア戦「ディマーケイション」を再現
- 交互回転により弾の隙間が複雑に変化する

---

## スキル使用AI

### 優先順位

1. **Wスキル**: 最優先で使用（Qスキルが使用中でない場合）
2. **Qスキル**: Wスキルが使用中でない場合に使用
3. **Eスキル**: 他のスキルが使用中でない場合に使用

### 初期クールダウン

| スキル | スポーン後の待機時間 |
|--------|---------------------|
| Qスキル | 1000ms |
| Wスキル | 2000ms |
| Eスキル | 3000ms |

### 移動AI

- プレイエリア上部1/4の高さを目標位置として移動
- プレイヤーのX座標に緩やかに追従（速度50%）
- スキル使用中は移動停止
- 移動範囲はプレイエリア上半分に制限

---

## 設定ファイル

スキルパラメータは `src/config/GameConfig.ts` の `BOSS_CONFIG.RUMIA` で定義されています。

```typescript
BOSS_CONFIG.RUMIA.SKILL_Q  // Qスキル設定
BOSS_CONFIG.RUMIA.SKILL_W  // Wスキル設定
BOSS_CONFIG.RUMIA.SKILL_E  // Eスキル設定
```
