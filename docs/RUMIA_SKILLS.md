# ルーミア（Rumia）スキル詳細

ステージ1ボス「宵闇の妖怪」

## 基本ステータス

| ステータス | 値 |
|-----------|-----|
| HP | 5000（フェーズ0） |
| ATK | 25 |
| DEF | 50 (約33%ダメージ軽減) |
| 移動速度 | 120 px/s |
| ヒットボックス半径 | 40 px |

## アニメーション

| 状態 | 使用スプライト | フレーム数 | フレームレート |
|------|---------------|-----------|---------------|
| 待機中 | rumia_koma2.png | 4 | 1.5fps |
| 詠唱中 | rumia_koma1.png | 4 | 1.5fps |
| 移動中 | rumia_koma3.png | 2 | 4fps |

- 待機・詠唱のフレーム順: 1→3→2→4
- 移動のフレーム順: 1→2

---

## Qスキル「通常弾幕1」

プレイヤー方向に向けて予告線を順次表示し、弾幕を発射する基本攻撃スキル。
**CC（スタン）で中断可能。**

### パラメータ

| 項目 | 値 |
|------|-----|
| 詠唱時間 | 1400ms (7本 × 200ms) |
| クールダウン | 5000ms |
| 基礎ダメージ | 30 |
| ATK係数 | 0.5 (ATK × 50%) |

### 弾幕パラメータ

| 項目 | 値 |
|------|-----|
| 予告線の本数 | 7本 |
| 予告線の出現間隔 | 200ms |
| 予告線から弾発射までの遅延 | 300ms |
| 縦方向の弾数 | 10発/列 |
| 縦方向の弾間隔 | 40px |
| 横方向の弾間隔 | 30px |
| 弾速 | 1100 px/s (20m/s) |
| 弾の半径 | 13.75px (0.25m) |
| 弾タイプ | KSHOT.MEDIUM_BALL.RED |
| 表示スケール | 0.06 |

### 予告線ごとの弾数

| 予告線番号 | 横方向の列数 |
|-----------|-------------|
| 1本目 | 1列 |
| 2-3本目 | 2列 |
| 4-6本目 | 3列 |
| 7本目 | 4列 |

### 挙動

1. **詠唱フェーズ**: 200ms間隔で予告線が順次出現（各予告線はプレイヤー方向を狙う）
2. **発射フェーズ**: 各予告線の出現から300ms後に弾幕発射
3. 弾は「八の字」に広がるように角度がつく（各列が中心から3度ずつ広がる）
4. CCで中断された場合、即座にクールダウンに入る

---

## Wスキル「通常弾幕2」

ルーミアを中心に異なる速度で広がる弾幕のリングを3つ同時に生成する。

### パラメータ

| 項目 | 値 |
|------|-----|
| 詠唱時間 | 500ms |
| クールダウン | 4000ms |
| 基礎ダメージ | 50 |
| ATK係数 | 0.8 (ATK × 80%) |

### 弾幕パラメータ

| 項目 | 値 |
|------|-----|
| リング数 | 3 |
| 1リングあたりの弾数 | 20発 |
| 弾の半径 | 13.75px (0.25m) |
| 弾タイプ | KSHOT.MEDIUM_BALL.CYAN（水色） |
| 表示スケール | 0.06 |
| リング1の弾速 | 275 px/s (5m/s) |
| リング2の弾速 | 550 px/s (10m/s) |
| リング3の弾速 | 825 px/s (15m/s) |

### 挙動

1. **詠唱フェーズ**: 500msの詠唱時間
2. **発射フェーズ**: 3つのリング弾幕を同時に発射
   - 各リングは20発の弾が360度に均等配置
   - 外側のリングほど速く広がる（5m/s, 10m/s, 15m/s）
   - 発射と同時にSE（shot1.mp3）再生

### 備考

- シンプルな全方位弾幕パターン
- 速度差により徐々にリングが広がっていく視覚効果

---

## Eスキル「通常弾幕3」

ルーミアが1秒かけてランダム方向に移動しながら、2列の弾を配置して発射する。
**CC（スタン）で中断可能（ブレイク）。**

### パラメータ

| 項目 | 値 |
|------|-----|
| 詠唱時間 | 0ms（即座に移動開始） |
| クールダウン | 6000ms |
| 基礎ダメージ | 20 |
| ATK係数 | 0.3 (ATK × 30%) |

### 移動パラメータ

| 項目 | 値 |
|------|-----|
| 移動時間 | 1000ms (1秒) |
| 移動距離 | 275px (5m) |
| 移動方向 | ランダム（プレイエリア内に収まるよう調整） |

### 弾幕パラメータ

| 項目 | 値 |
|------|-----|
| 弾列数 | 2列（移動方向の前方に配置） |
| 1列あたりの弾数 | 20発 |
| 弾配置間隔 | 50ms |
| 列の間隔 | 55px (1m) |
| 弾の半径 | 13.75px (0.25m) |
| 弾タイプ | KSHOT.RINDAN.GREEN（輪弾・緑） |
| 表示スケール | 0.1 |

### 弾速パラメータ（山型）

| 弾のインデックス | 弾速 |
|----------------|------|
| 1発目 | 165 px/s (3m/s) |
| 2発目 | 192.5 px/s (3.5m/s) |
| ... | +27.5 px/s ずつ増加 |
| 11発目（ピーク） | 440 px/s (8m/s) |
| 12発目 | 412.5 px/s (7.5m/s) |
| ... | -27.5 px/s ずつ減少 |
| 20発目 | 192.5 px/s (3.5m/s) |

### 挙動

1. **発動**: 詠唱なしで即座に移動開始
2. **移動フェーズ**: 1秒かけてランダム方向に5m移動
   - 移動中は詠唱中判定（CCで中断可能）
3. **弾配置**: 移動中、50ms間隔で2列の弾を配置
   - 弾は移動方向の前方に2列配置（列の間隔1m）
   - 各弾はプレイヤー方向に発射
4. **弾速**: 山型（1発目→11発目で最速→20発目で減速）
5. CCで中断された場合、即座にクールダウンに入る（ブレイク）

### 備考

- 移動弾幕パターン
- 弾速が山型になることで、中央付近の弾が追い越し、弾の密度が変化する
- 移動方向はプレイエリア内に収まるよう自動調整される

---

## スキル使用AI

### 優先順位

1. **Wスキル**: 最優先で使用（Qスキルが使用中でない場合）
2. **Qスキル**: Wスキルが使用中でない場合に使用
3. **Eスキル**: 他のスキルが使用中でない場合に使用

### 初期クールダウン

| スキル | スポーン後の待機時間 |
|--------|---------------------|
| Qスキル | 1000ms |
| Wスキル | 2000ms |
| Eスキル | 3000ms |

### 移動AI

- プレイエリア上部1/4の高さを目標位置として移動
- プレイヤーのX座標に緩やかに追従（速度50%）
- スキル使用中は移動停止
- 移動範囲はプレイエリア上半分に制限

---

## フェーズ1（スペルカード）: ダークサイドオブザムーン

### Rスキル「闇符・ダークサイドオブザムーン」

ルーミアが黒い球体に変化し、無敵状態でプレイヤーを追尾しながら弾幕を発射する。

#### パラメータ

| 項目 | 値 |
|------|-----|
| 詠唱時間 | 600ms |
| クールダウン | 8000ms |
| 基礎ダメージ | 40 |
| ATK係数 | 0.5 (ATK × 50%) |

#### 移動パラメータ

| 項目 | 値 |
|------|-----|
| 無敵時間 | 3000ms (3秒) |
| 移動距離 | 275px (5m) |
| 移動速度 | 165px/s (3m/s) |
| 移動方式 | プレイヤー追尾 |

#### 弾幕パラメータ

**輪弾RED（赤い輪弾）**
| 項目 | 値 |
|------|-----|
| 発射数 | ランダム4発/回 |
| 弾の半径 | 13.75px (0.25m) |
| 弾速 | 110px/s (2m/s) |
| 弾タイプ | KSHOT.RINDAN.RED |
| 発射タイミング | 100ms, 300ms, 500ms... (200ms間隔、10回) |

**黒縁中玉WHITE（白い中玉）**
| 項目 | 値 |
|------|-----|
| 発射数 | ランダム4発/回 |
| 弾の半径 | 6.875px (0.125m) |
| 弾速 | 55px/s (1m/s) |
| 弾タイプ | KSHOT.MEDIUM_BALL.WHITE |
| 発射タイミング | 0ms, 200ms, 400ms... (200ms間隔、10回) |

**終了時リング弾（黄色中玉）**
| 項目 | 値 |
|------|-----|
| 発射数 | 20発（360度均等配置） |
| 弾の半径 | 27.5px (0.5m) |
| 弾速 | 165px/s (3m/s) |
| 弾タイプ | KSHOT.MEDIUM_BALL.YELLOW |

#### スプライト

| 状態 | 使用スプライト | サイズ |
|------|---------------|--------|
| Rスキル実行中 | rumia_koma5.png | 55px × 55px (1m × 1m) |

#### 挙動

1. **詠唱フェーズ**: 600msの詠唱
2. **実行フェーズ**:
   - ルーミアが黒い球体に変化（rumia_koma5.png）
   - 3秒間の無敵状態
   - プレイヤーを追尾しながら移動
   - 200ms間隔で輪弾RED（4発）と黒縁中玉WHITE（4発）を交互に発射（計10回ずつ）
3. **終了時**: 黄色の中玉を20発リング状に発射
4. **復帰**: 通常スプライトに戻る

### Qスキル「オーブオブディセプション」

360度均等に9発の球を円状に発射し、最大射程到達後にルーミアを追尾しながら戻ってくる。

#### パラメータ

| 項目 | 値 |
|------|-----|
| キャスト時間 | 250ms (0.25秒) |
| クールダウン | 5000ms |
| 基礎ダメージ | 50 |
| ATK係数 | 0.6 (ATK × 60%) |

#### 弾パラメータ

| 項目 | 値 |
|------|-----|
| 弾数 | 9発（円状配置、40度間隔） |
| 射程 | 495px (9m) |
| 弾幕判定半径 | 44px (0.8m) |
| 弾タイプ | KSHOT.LARGE_BALL.CYAN（シアン大玉） |
| 表示スケール | 0.172 (直径1.6m = 88px) |

#### 弾速パラメータ

**行き（outgoing）**
| 項目 | 値 |
|------|-----|
| 弾速 | 825px/s (15m/s) |

**帰り（returning）**
| 項目 | 値 |
|------|-----|
| 初速 | 33px/s (0.6m/s) |
| 加速度 | 1045px/s² (19m/s²) |
| 最大速度 | 1430px/s (26m/s) |

#### 挙動

1. **詠唱フェーズ**: 250msの詠唱
2. **行きフェーズ**:
   - 360度均等に9発の球を40度間隔で円状に発射
   - 各弾が最大射程9mに到達するまで直進
3. **帰りフェーズ**:
   - 各弾がルーミアの現在位置を追尾しながら戻る
   - 初速0.6m/sから19m/s²で加速（最大26m/s）
4. **終了**: すべての弾がルーミアに接触したらスキル完了

### W/Eスキル

フェーズ1では現在無効化されています（リメイク予定）。

---

## 設定ファイル

スキルパラメータは `src/config/GameConfig.ts` の `BOSS_CONFIG.RUMIA` で定義されています。

```typescript
BOSS_CONFIG.RUMIA.PHASE_0_SKILLS  // フェーズ0（ノーマル）のスキル設定
BOSS_CONFIG.RUMIA.PHASE_1_SKILLS  // フェーズ1（スペルカード）のスキル設定
```
