# ボス戦システム設計

## ステージフロー

```
道中（雑魚敵）→ ボス戦開始 → ボス撃破 → ステージクリア
```

※中ボスは廃止

---

## ボス戦フェーズシステム

ボスは複数のフェーズを持ち、各フェーズで独自のHP・スキルセットを持つ。

```
ノーマルフェーズ（通常技）
    ↓ HP0 → カットイン演出
スペルカード1
    ↓ HP0 → カットイン演出
スペルカード2
    ↓ HP0 → カットイン演出
...
最終フェーズ
    ↓ HP0 → 撃破演出
ステージクリア
```

### フェーズ構成

| 項目 | 説明 |
|------|------|
| フェーズHP | 各フェーズ独自のHP |
| スキルセット | QWER（4スキル）がフェーズごとに完全に変わる |
| カットイン | フェーズ撃破時にスペルカード名を表示 |
| タイムボーナス | 制限時間内クリアでボーナス（将来実装） |

---

## ルーミア フェーズ設計

### フェーズ0: ノーマル（通常技）

**HP**: 5000

| スキル | 名前 | 説明 |
|--------|------|------|
| Q | 月符・ムーンライトレイ | 7way弾（現行実装） |
| W | 闇符・ダークサイドオブムーン | 5本レーザー（現行実装） |
| E | 闘符・ディマーケイション | 拡大回転リング弾（現行実装） |
| R | (未定) | ノーマル用の追加技 |

### フェーズ1: スペルカード「夜符・ナイトバード」

**HP**: 4000

| スキル | 名前 | 説明 |
|--------|------|------|
| Q | (新規) | スペカ1用の技 |
| W | (新規) | スペカ1用の技 |
| E | (新規) | スペカ1用の技 |
| R | (新規) | スペカ1用の技 |

### フェーズ2: スペルカード「闇符・ダームリプレイング」

**HP**: 4000

| スキル | 名前 | 説明 |
|--------|------|------|
| Q | (新規) | スペカ2用の技 |
| W | (新規) | スペカ2用の技 |
| E | (新規) | スペカ2用の技 |
| R | (新規) | スペカ2用の技 |

---

## 実装方針

### 1. Boss基底クラスの改修

```typescript
abstract class Boss {
  // フェーズ管理
  protected currentPhase: number = 0;
  protected phases: BossPhase[];

  // フェーズ切り替え
  protected onPhaseComplete(): void;
  protected transitionToNextPhase(): void;

  // カットイン演出
  protected showSpellCardCutIn(name: string): void;
}

interface BossPhase {
  name: string;           // フェーズ名（スペルカード名）
  hp: number;             // このフェーズのHP
  skills: PhaseSkillSet;  // QWER スキルセット
  isFinal: boolean;       // 最終フェーズかどうか
}
```

### 2. スキル管理の変更

- 現行: Q, W, E が固定
- 新規: フェーズごとに Q, W, E, R が完全に入れ替わる

```typescript
interface PhaseSkillSet {
  Q: BossSkillConfig;
  W: BossSkillConfig;
  E: BossSkillConfig;
  R: BossSkillConfig;
}
```

### 3. GameConfig の構造変更

```typescript
BOSS_CONFIG.RUMIA = {
  // 基本ステータス（全フェーズ共通）
  ATK: 25,
  DEF: 50,
  MOVE_SPEED: 120,
  HITBOX_RADIUS: 40,

  // フェーズ定義
  PHASES: [
    {
      NAME: 'ノーマル',
      HP: 5000,
      SKILLS: {
        Q: { /* ムーンライトレイ */ },
        W: { /* ダークサイドオブムーン */ },
        E: { /* ディマーケイション */ },
        R: { /* 新技 */ },
      }
    },
    {
      NAME: '夜符・ナイトバード',
      HP: 4000,
      SKILLS: { ... }
    },
    // ...
  ]
}
```

### 4. UI表示

- ボスHPバーにフェーズ数を表示（例: ★★★）
- 現在フェーズのスペルカード名を表示
- フェーズ切り替え時にカットイン演出

---

## 移行作業

1. [ ] Boss基底クラスにフェーズシステム追加
2. [ ] GameConfig.tsの構造変更
3. [ ] Rumia.tsをフェーズ対応に改修
4. [ ] カットイン演出システム実装
5. [ ] UIにフェーズ表示追加
6. [ ] GameSceneの中ボス関連コード削除
