# UI設計書

## 概要

MOBA × TOUHOUゲームのUI設計。LoLライクなスキルHUDとキャラクター情報表示を実装する。

## 画面レイアウト

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                                1920 x 1080                                  │
│                                                                             │
│  ┌──────────────┐          ┌────────────────────────┐   ┌──────────────┐   │
│  │              │          │                        │   │              │   │
│  │   エネミー    │          │                        │   │   プレイヤー  │   │
│  │   ゾーン     │          │     プレイエリア        │   │    ゾーン    │   │
│  │   (左側)    │          │      800 x 1000        │   │   (右側)     │   │
│  │             │          │                        │   │              │   │
│  │  ┌───────┐  │          │                        │   │  ┌───────┐   │   │
│  │  │       │  │          │                        │   │  │       │   │   │
│  │  │ 立ち絵 │  │          │                        │   │  │ 立ち絵 │   │   │
│  │  │(半透明)│  │          │                        │   │  │(半透明)│   │   │
│  │  │       │  │          │                        │   │  │       │   │   │
│  │  └───────┘  │          │                        │   │  └───────┘   │   │
│  │             │          │                        │   │              │   │
│  │ ボス名      │          │                        │   │ キャラ名     │   │
│  │ HPバー      │          │                        │   │ HP/Stats    │   │
│  │             │          │                        │   │ バフ表示     │   │
│  │             │          └────────────────────────┘   │              │   │
│  │             │                                       │              │   │
│  └──────────────┘          ┌─────HUDエリア────────┐   └──────────────┘   │
│                            │                      │                       │
│  Q W E R D F               │                      │   Q W E R D F         │
│  ████ HPバー ████           │                      │   ████ HPバー ████    │
│                            └──────────────────────┘                       │
└─────────────────────────────────────────────────────────────────────────────┘
```

## ゾーン配置

```
  0        560       1360      1920
  │         │         │         │
  │◄──────►│◄───────►│◄──────►│
  │  560px │  800px  │  560px  │
  │        │         │         │
  │ エネミー│プレイ   │プレイヤー│
  │ ゾーン │エリア   │ ゾーン  │

  Y方向:
  0 ────────────────────────── 960 (HUD上端)
  │     立ち絵ゾーン（半透明）    │
  │     キャラ情報表示           │
  960 ─────────────────────── 1080
  │     HUDエリア               │
  │     スキルスロット + HPバー   │
```

## コンポーネント設計

### 1. UIManager（メイン管理クラス）

```typescript
// src/ui/UIManager.ts
class UIManager {
  private scene: Phaser.Scene;
  private player: Player;

  // 子コンポーネント
  private playerZone: PlayerZone;
  private enemyZone: EnemyZone;

  constructor(scene, player);
  update(time, delta): void;
  showBossInfo(enemy: Enemy): void;
  hideBossInfo(): void;
  destroy(): void;
}
```

### 2. PlayerZone（プレイヤーゾーン・右側全体）

立ち絵 + ステータス表示 + スキルバー + HPバー を統合

```
┌────────────────────────────────────┐
│                                    │
│         ┌────────────────┐         │
│         │                │         │
│         │                │         │
│         │    博麗 霊夢    │         │
│         │    (立ち絵)     │         │
│         │   半透明30%    │         │
│         │                │         │
│         │                │         │
│         └────────────────┘         │
│                                    │
│  ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━  │
│                                    │
│  博麗 霊夢                          │
│  HP: 75 / 100                      │
│  ATK: 10                           │
│  AS: 2.0 (3.0)                     │
│  SPD: 300                          │
│  ─────────────────                 │
│  [AS↑ 4.2s]                        │
│                                    │
├────────────────────────────────────┤
│      Q   W   E   R   D   F         │  ← HUDエリア
│     ┌──┐┌──┐┌──┐┌──┐┌──┐┌──┐      │
│     │  ││  ││  ││  ││  ││  │      │
│     └──┘└──┘└──┘└──┘└──┘└──┘      │
│  ████████████████░░░░░░░░░░░░░░░░  │  ← HPバー
└────────────────────────────────────┘
```

### 3. EnemyZone（エネミーゾーン・左側全体）

ボス/中ボス戦時のみ表示

```
┌────────────────────────────────────┐
│                                    │
│         ┌────────────────┐         │
│         │                │         │
│         │                │         │
│         │     ボス       │         │
│         │    (立ち絵)     │         │
│         │   半透明30%    │         │
│         │                │         │
│         │                │         │
│         └────────────────┘         │
│                                    │
│  ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━  │
│                                    │
│  紅 美鈴                           │
│  ████████░░░░░░░░░░░░░░░░░░░░░░░░  │
│  500 / 2000 HP                     │
│                                    │
│  [PHASE 2]                         │
│                                    │
└────────────────────────────────────┘
```

## 配置座標

```typescript
const UI_LAYOUT = {
  // HUDエリアの高さ
  HUD_HEIGHT: 120,

  // エネミーゾーン（左側全体）
  ENEMY_ZONE: {
    X: 0,
    Y: 0,
    WIDTH: 560,
    HEIGHT: 960,  // HUDより上
    PORTRAIT: {
      X: 280,
      Y: 480,     // ゾーン中央
      WIDTH: 500,
      HEIGHT: 800,
      ALPHA: 0.3,
    },
  },

  // プレイヤーゾーン（右側全体）
  PLAYER_ZONE: {
    X: 1360,
    Y: 0,
    WIDTH: 560,
    HEIGHT: 960,  // HUDより上
    PORTRAIT: {
      X: 1640,
      Y: 480,     // ゾーン中央
      WIDTH: 500,
      HEIGHT: 800,
      ALPHA: 0.3,
    },
    SKILL_BAR: {
      X: 1640,
      Y: 1020,    // HUDエリア内
      SLOT_SIZE: 64,
      SLOT_GAP: 8,
      HP_BAR: {
        WIDTH: 400,
        HEIGHT: 24,
        OFFSET_Y: 45,
      },
    },
  },
};
```

## ファイル構成

```
src/ui/
├── UIManager.ts              # UI全体の管理
├── components/
│   ├── SkillSlotUI.ts       # 個別スキルスロット
│   ├── HealthBar.ts         # HPバー（共通コンポーネント）
│   ├── PlayerZone.ts        # プレイヤーゾーン（右側全体）
│   └── EnemyZone.ts         # エネミーゾーン（左側全体）
└── constants/
    └── UIConstants.ts       # UI用定数
```

## 更新フロー

```
GameScene.update()
    ↓
UIManager.update(time, delta)
    ↓
┌───────────────────────────────────┐
│ PlayerZone.update()               │
│   ├─ 立ち絵更新                   │
│   ├─ ステータス更新                │
│   │   └─ HP/ATK/AS/SPD + バフ    │
│   ├─ バフ表示更新                 │
│   ├─ スキルスロット更新 x 6        │
│   │   ├─ getSkillCooldownRemaining()
│   │   ├─ getWSkillStacks()
│   │   └─ getWSkillNextStackTime()
│   └─ HPバー更新                   │
├───────────────────────────────────┤
│ EnemyZone.update() ※ボス戦時のみ  │
│   ├─ 立ち絵更新                   │
│   ├─ ボス名/HP表示                │
│   └─ フェーズ表示                 │
└───────────────────────────────────┘
```

## 実装優先度

### Phase 1（完了）
1. UIManager基盤
2. PlayerZone（立ち絵 + ステータス + スキルバー + HPバー）
3. EnemyZone（ボス戦用）

### Phase 2（今後）
4. 立ち絵画像の実装
5. アニメーション追加
6. ボス登場演出
7. サウンドフィードバック連携

## 注意事項

- 立ち絵は仮でプレースホルダー画像を使用（後で差し替え）
- エネミーゾーンは通常時非表示、ボス戦時のみ表示
- スキルバーはプレイヤーゾーンの下部（HUDエリア）に配置
